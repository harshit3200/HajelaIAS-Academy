{% load custom_tags %}

<table class="table table-bordered">
    <thead>
        <tr class="text-center">
            <th>Question No.</th>
            <th>Question</th>
            <th>Options</th>
            <th>Question Type</th>
            <th>Created At</th>
        </tr>
    </thead>
    <tbody id="questions-table-body">
        {% for question in questions %}
            <tr>
                <!-- Question No -->
                <td>
                    Question {{ question.question_number }}:
                    {% if question.exam_name.all %}
                        {% for exam in question.exam_name.all %}
                            {{ exam.name }}{% if not forloop.last %} - {% endif %}
                        {% endfor %}
                    {% else %}
                        None
                    {% endif %}
                </td>

                <!-- Question Text -->
                <td>
                    {% if question.question_sub_type in 'simple_type true_and_false_type fill_in_the_blank_type' %}
                        {{ question.question_part|default:"No question text available" }}
                    {% elif question.question_sub_type == 'r_and_a_type' %}
                        {{ question.question_part_first|default:"No question text available" }}
                        <br><strong>Reason:</strong> {{ question.reason|default:"No reason available" }}
                        <br><strong>Assertion:</strong> {{ question.assertion|default:"No assertion available" }}
                    {% elif question.question_sub_type == 'list_type_1' %}
                        <strong>First Part:</strong> {{ question.question_part_first|default:"No question text available" }}
                        <br>
                        <ol type="1">
                            {% for i in 1|to_range:8 %}
                                {% with "list_1_row"|add:i as field %}
                                    {% if question|get_dynamic_field:field %}
                                        <li>{{ question|get_dynamic_field:field }}</li>
                                    {% endif %}
                                {% endwith %}
                            {% endfor %}
                        </ol>
                    {% elif question.question_sub_type == 'list_type_2' %}
                        <strong>{{ question.list_1_name|default:"List-I" }}:</strong>
                        <ol type="A">
                            {% for i in 1|to_range:8 %}
                                {% with "list_1_row"|add:i as field %}
                                    {% if question|get_dynamic_field:field %}
                                        <li>{{ question|get_dynamic_field:field }}</li>
                                    {% endif %}
                                {% endwith %}
                            {% endfor %}
                        </ol>
                        <strong>{{ question.list_2_name|default:"List-II" }}:</strong>
                        <ol type="1">
                            {% for i in 1|to_range:8 %}
                                {% with "list_2_row"|add:i as field %}
                                    {% if question|get_dynamic_field:field %}
                                        <li>{{ question|get_dynamic_field:field }}</li>
                                    {% endif %}
                                {% endwith %}
                            {% endfor %}
                        </ol>
                    {% else %}
                        No question details available.
                    {% endif %}
                </td>

                <!-- Options -->
                <td>
                    <p>(a) {{ question.answer_option_a|default:"Option A not available" }}</p>
                    <p>(b) {{ question.answer_option_b|default:"Option B not available" }}</p>
                    <p>(c) {{ question.answer_option_c|default:"Option C not available" }}</p>
                    <p>(d) {{ question.answer_option_d|default:"Option D not available" }}</p>
                </td>

                <!-- Question Type -->
                <td>{{ question.get_question_sub_type_display|default:"Unknown" }}</td>

                <!-- Created At -->
                <td>{{ question.created_at|date:"M d, Y, H:i" }}</td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="5" class="text-center">No questions found.</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
